---
title: "map-statistics"
format: html
---

# Read in libraries

```{r}
library(conflicted)
library(terra)
library(tidyverse)
library(ggplot2)
library(viridis)

conflict_prefer("extract", "terra")
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
```


# Read in coverage map, slope, mask, and digital elevation model

```{r}
dem <- terra::rast("clean_data/drone_sitched/dem.tif")
coverage <- terra::rast('clean_data/drone_sitched/pred_map.tif')

mask <- terra::vect('clean_data/drone_sitched/Mask_Grass_Paper.shp') |>
  terra::project(crs(dem))

if(!file.exists('outputs/slope.tif')){
  slope <- terra::terrain(dem, v="slope", unit="degrees")
  terra::writeRaster(slope, 'outputs/slope.tif')
} else {
  slope <- terra::rast('outputs/slope.tif')
}
```

# Plot mask over orthos

```{r}
create_plot <- function(raster, title, color_scale = viridis::viridis) {
  plot(raster, main = title, col = color_scale(100))
  lines(mask, col = "red", lwd = 2)
}

create_plot(dem, "Digital Elevation Model with Mask")
create_plot(coverage, "Vegetation Coverage with Mask")
create_plot(slope, "Slope with Mask", color_scale = terrain.colors)

```
